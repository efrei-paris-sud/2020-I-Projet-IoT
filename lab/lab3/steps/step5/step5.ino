/*********************************************************************

  Démonstration d'un écran OLED i2c SH1106 avec un Arduino,
  en utilisant une bibliothèque d'Adafruit:

  https://github.com/adafruit/Adafruit-GFX-Library

  ...et une bibliothèque compatible par Wohho-maker:

  https://github.com/wonho-maker/Adafruit_SH1106
  
  Plus d'infos:
  https://electroniqueamateur.blogspot.com/2019/01/ecran-oled-sh1106-i2c-et-arduino.html

*********************************************************************/

#include <Wire.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SH1106.h>

/* Puisque la bibliothèque est basée sur celle du SSD1306, le constructeur
prévoit qu'on passe le numéro de la broche RESET en argument. Mais le SH1106
n'a pas de broche RESET, alors on écrit n'importe quel entier (de préférence,
le numéro d'une broche de l'Arduino que vous n'utilisez pas). */
Adafruit_SH1106 display(23); 

/* Définition d'une image bitmap: logo du blog Électronique en Amateur
  Réalisée avec l'outil en ligne  http://javl.github.io/image2cpp/  */

const unsigned char myBitmap [] PROGMEM = {
  // 'loutre', 128x64px
0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x03, 0xe0, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0xff, 0x82, 0x02, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x60, 0x03, 0xf0, 0x03, 0x02, 0x1c, 0x04, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x38, 0x00, 0xf8, 0x01, 0x81, 0x8c, 0x0e, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x1f, 0xe2, 0x1e, 0x00, 0x00, 0xba, 0x0c, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x3f, 0xff, 0x87, 0x00, 0x01, 0x81, 0x40, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x7f, 0xff, 0xf0, 0xc3, 0x03, 0x80, 0xe0, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x02, 0x00, 0x7f, 0xff, 0xfc, 0x33, 0x03, 0xa0, 0xc0, 0x00, 0x00, 0x81, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x3f, 0xff, 0xfd, 0x03, 0xdf, 0x00, 0x00, 0x00, 0x47, 0xc0, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x1f, 0xff, 0xff, 0x2f, 0xff, 0x00, 0x00, 0x12, 0x46, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x01, 0x20, 0x0f, 0xff, 0xff, 0xff, 0xff, 0xe0, 0x00, 0x07, 0x80, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x02, 0x04, 0x1f, 0xff, 0xff, 0xff, 0xff, 0xf0, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x18, 0x02, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xfc, 0x60, 0x00, 0x00, 0x20, 0xff, 0xff, 0xff, 
0x00, 0x0c, 0x40, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xe1, 0xf8, 0x00, 0x21, 0xff, 0xff, 0xff, 
0x00, 0x06, 0x00, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xe0, 0x00, 0x00, 0x10, 0xff, 0xff, 0xff, 
0x00, 0x01, 0x83, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xe0, 0x00, 0x00, 0x16, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xe1, 0x01, 0x00, 0x03, 0xff, 0xff, 0xff, 
0x00, 0x81, 0x0f, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xe0, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x03, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf0, 0x00, 0x04, 0x08, 0xff, 0xff, 0xff, 
0x00, 0x01, 0xf1, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf0, 0xc0, 0x04, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x11, 0xff, 0xff, 0xff, 0xff, 0xff, 0xdf, 0xf0, 0xf8, 0x24, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x03, 0xff, 0xfd, 0xff, 0xff, 0xff, 0xff, 0xf0, 0x04, 0x00, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x21, 0x83, 0x7f, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xf8, 0x00, 0x38, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x03, 0xff, 0x73, 0xff, 0xff, 0xff, 0xff, 0xf3, 0x04, 0x80, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x07, 0xff, 0xbf, 0xff, 0xff, 0xff, 0xff, 0xe2, 0x50, 0x84, 0x60, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x07, 0xff, 0x23, 0x03, 0xff, 0xff, 0xff, 0xe6, 0x31, 0x84, 0x40, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x01, 0xfc, 0x62, 0x01, 0xff, 0xe5, 0xff, 0xf7, 0x12, 0x4c, 0x48, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x25, 0x7c, 0x50, 0x00, 0x18, 0x40, 0xff, 0xf7, 0x02, 0x64, 0x51, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x08, 0xf0, 0x00, 0x00, 0x20, 0x00, 0xff, 0x7f, 0x20, 0x68, 0x60, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0xb0, 0x40, 0x04, 0xd0, 0x00, 0x7f, 0xff, 0x6e, 0x20, 0xc2, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x08, 0x41, 0x1c, 0x00, 0x00, 0x3f, 0xff, 0xff, 0xa0, 0xc8, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x28, 0x01, 0xfc, 0x04, 0x00, 0xfb, 0xff, 0x8f, 0xb0, 0xc0, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x01, 0xfc, 0x7f, 0x81, 0x7f, 0xff, 0x9f, 0xf0, 0x74, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x01, 0xff, 0xbf, 0xc7, 0x7b, 0xff, 0xcf, 0xf8, 0x04, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x01, 0xff, 0x7f, 0xfe, 0x1f, 0xf1, 0xdf, 0xce, 0x20, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x01, 0xff, 0xff, 0xfc, 0x0f, 0x01, 0xff, 0x0e, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x01, 0xff, 0xff, 0xf9, 0x5e, 0x01, 0xfa, 0xc6, 0x0c, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x01, 0xff, 0xff, 0xff, 0x1c, 0x03, 0xfe, 0xe7, 0x0c, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x01, 0xff, 0xff, 0xff, 0x54, 0x03, 0xfb, 0xf6, 0x04, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xef, 0xdf, 0xc2, 0x01, 0xe3, 0xf4, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xcf, 0xef, 0xe3, 0x81, 0xff, 0xfa, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x01, 0x9f, 0xdf, 0xff, 0xf7, 0x03, 0xff, 0xbf, 0x80, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x9f, 0xdf, 0xfe, 0x07, 0xf0, 0x00, 0x78, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x6f, 0x7b, 0xf8, 0x0f, 0xff, 0x80, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x85, 0xff, 0xe0, 0x17, 0xff, 0xc1, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0xd4, 0x31, 0xff, 0xbc, 0x00, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x02, 0x29, 0xff, 0xef, 0xf4, 0x05, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x0d, 0x7f, 0xff, 0xf0, 0x01, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0xbf, 0xfc, 0x50, 0x00, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xbb, 0x3c, 0x42, 0x10, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x34, 0x02, 0x10, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x08, 0x30, 0x00, 0x59, 0x90, 0x20, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x1f, 0x05, 0xf8, 0x10, 0x10, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x8e, 0x08, 0x06, 0x40, 0x1f, 0x98, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x1e, 0x1c, 0x00, 0x10, 0x0f, 0x18, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0xbc, 0x06, 0x00, 0x40, 0x07, 0x38, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0xbe, 0x00, 0x3c, 0x00, 0x43, 0x38, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xb8, 0x00, 0xfc, 0x00, 0x01, 0x60, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xa0, 0x21, 0xff, 0x00, 0x00, 0xc0, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xa8, 0x00, 0x4f, 0xc0, 0x00, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xa8, 0x01, 0x0f, 0xe0, 0x00, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x01, 0x80, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff
};


void setup()   {

  display.begin();  // initialisation de l'afficheur
  display.clearDisplay();   // ça efface à la fois le buffer et l'écran
}


void loop() {

  /**************************** Dessiner une image  bitmap **********************************/

  // on affiche l'image stockée dans la constante myBitmap définie au début de ce fichier.

  display.fillRect(5,5,128,64,WHITE);  // fond blanc derrière l'image bitmap
  
  display.drawBitmap(10, 10, myBitmap, 128, 64, BLACK);

  display.setCursor(60, 30);  // coordonnées du point de départ du texte
  display.setTextColor(WHITE);
  display.setTextSize(1);  // taille par défaut
  display.println("Au revoir!");

  display.display();
  delay(2000);
  display.clearDisplay();

}
